<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin - T·∫°o truy·ªán m·ªõi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body class="bg-gray-100 min-h-screen">
    <!-- Layout Container -->
    <div class="flex">
      <!-- Sidebar -->

      <!-- Main Content -->
      <div class="flex-1">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b">
          <div class="flex justify-between items-center px-6 py-4">
            <div>
              <h1 class="text-2xl font-semibold text-gray-800">
                T·∫°o truy·ªán m·ªõi
              </h1>
              <p class="text-gray-600 text-sm">
                Th√™m m·ªôt truy·ªán m·ªõi v√†o h·ªá th·ªëng
              </p>
            </div>
            <div class="flex items-center space-x-4">
              <div class="flex items-center space-x-2">
                <span class="text-sm font-medium text-gray-700">Admin</span>
              </div>
            </div>
          </div>
        </header>

        <!-- Form Content -->
        <div class="p-6">
          <div class="max-w-3xl mx-auto">
            <!-- Form Card -->
            <div class="bg-white rounded-lg shadow-md p-6">
              <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">
                  <i class="fas fa-plus-circle text-blue-600 mr-2"></i>
                  T·∫°o truy·ªán m·ªõi
                </h2>
                <p class="text-gray-600">
                  ƒêi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin ƒë·ªÉ t·∫°o truy·ªán m·ªõi
                </p>
              </div>

             <form class="space-y-6" method="POST" action="/admin/stories"  enctype="multipart/form-data">
  <!-- T√™n truy·ªán -->
  <div>
    <label class="block text-sm font-medium text-gray-700 mb-2">
      <i class="fas fa-book text-blue-500 mr-2"></i> T√™n truy·ªán
    </label>
    <input
      name="title"
      type="text"
      class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2
        <%= errors?.title ? 'border-red-500 ring-red-300' : 'border-gray-300 focus:ring-blue-500 focus:border-transparent' %>"
      placeholder="Nh·∫≠p t√™n truy·ªán..."
      value="<%= old?.title || '' %>"
    />
    <% if (errors?.title) { %>
      <p class="text-sm text-red-600 mt-1"><%= errors.title %></p>
    <% } %>
  </div>
  
<!-- File ·∫£nh -->
  <div>
  <label class="block text-sm font-medium text-gray-700 mb-2">
    <i class="fas fa-image text-pink-500 mr-2"></i> ·∫¢nh b√¨a truy·ªán
  </label>
  <input
    type="file"
    name="image"
    accept="image/*"
    class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 border-gray-300 focus:ring-blue-500"
  />
</div>

  <!-- VƒÉn √°n -->
  <div>
    <label class="block text-sm font-medium text-gray-700 mb-2">
      <i class="fas fa-file-alt text-green-500 mr-2"></i> VƒÉn √°n c·ªßa truy·ªán
    </label>
    <textarea
      name="summary"
      rows="4"
      class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2
        <%= errors?.summary ? 'border-red-500 ring-red-300' : 'border-gray-300 focus:ring-blue-500 focus:border-transparent' %>"
      placeholder="Vi·∫øt vƒÉn √°n gi·ªõi thi·ªáu v·ªÅ truy·ªán..."
    ><%= old?.summary || '' %></textarea>
    <% if (errors?.summary) { %>
      <p class="text-sm text-red-600 mt-1"><%= errors.summary %></p>
    <% } %>
  </div>


  <!-- Th·ªÉ lo·∫°i v√† T√°c gi·∫£ -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
   <div class="mb-6">
  <label for="genre" class="block text-sm font-semibold text-gray-800 mb-2">
    <i class="fas fa-tags text-purple-600 mr-2"></i> Th·ªÉ lo·∫°i truy·ªán
  </label>

  <% const selectedGenres = Array.isArray(old?.genre) ? old.genre : [old?.genre].filter(Boolean) %>
<% const genres = [
  { title: "ABO", value: "abo" },
  { title: "BE", value: "be" },
  { title: "B√°o Th√π", value: "bao-thu" },
  { title: "Ch·ªØa L√†nh", value: "chua-lanh" },
  { title: "Cung ƒê·∫•u", value: "cung-dau" },
  { title: "C·ªï ƒê·∫°i", value: "co-dai" },
  { title: "C·ª©u R·ªói", value: "cuu-roi" },
  { title: "Gia ƒê·∫•u", value: "gia-dau" },
  { title: "HE", value: "he" },
  { title: "Hi·ªán ƒê·∫°i", value: "hien-dai" },
  { title: "Ho√†ng Cung", value: "hoang-cung" },
  { title: "Ho√°n ƒê·ªïi Th√¢n X√°c", value: "hoan-doi-than-xac" },
  { title: "Huy·ªÅn Huy·ªÖn", value: "huyen-huyen" },
  { title: "H√†i H∆∞·ªõc", value: "hai-huoc" },
  { title: "H√†o M√¥n", value: "hao-mon" },
  { title: "H·ªá Th·ªëng", value: "he-thong" },
  { title: "Kinh D·ªã", value: "kinh-di" },
  { title: "Linh D·ªã", value: "linh-di" },
  { title: "M·∫°t Th·∫ø", value: "mat-the" },
  { title: "Ng√¥n T√¨nh", value: "ngon-tinh" },
  { title: "Ng∆∞·ª£c", value: "nguoc" },
  { title: "Ng·ªçt S·ªßng", value: "ngot-sung" },
  { title: "Nh√¢n Th√∫", value: "nhan-thu" },
  { title: "N·ªØ C∆∞·ªùng", value: "nu-cuong" },
  { title: "OE", value: "oe" },
  { title: "SE", value: "se" },
  { title: "Showbiz", value: "showbiz" },
  { title: "Sinh T·ªìn", value: "sinh-ton" },
  { title: "S·∫£ng VƒÉn", value: "sang-van" },
  { title: "Thanh Xu√¢n V∆∞·ªùn Tr∆∞·ªùng", value: "thanh-xuan-vuon-truong" },
  { title: "Thi√™n Kim", value: "thien-kim" },
  { title: "Th·∫ø Th√¢n", value: "the-than" },
  { title: "Tr·ªçng Sinh", value: "trong-sinh" },
  { title: "Tu Ti√™n", value: "tu-tien" },
  { title: "T√¨nh C·∫£m", value: "tinh-cam" },
  { title: "T√¨nh C·∫£m Gia ƒê√¨nh", value: "tinh-cam-gia-dinh" },
  { title: "T·ªïng T√†i", value: "tong-tai" },
  { title: "T·ªôi Ph·∫°m", value: "toi-pham" },
  { title: "V√£ M·∫∑t", value: "va-mat" },
  { title: "Xuy√™n Kh√¥ng", value: "xuyen-khong" },
  { title: "Xuy√™n S√°ch", value: "xuyen-sach" },
  { title: "ƒêam M·ªπ", value: "dam-my" },
  { title: "ƒêi·ªÅn VƒÉn", value: "dien-van" },
  { title: "ƒê·ªÅ c·ª≠", value: "de-cu" },
  { title: "ƒê·ªçc T√¢m", value: "doc-tam" }
] %>


  <div class="relative">
    <select
      name="genre[]"
      multiple
      class="w-full h-48 bg-white px-4 py-2 pr-10 border text-sm rounded-xl shadow-sm appearance-none
        focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500
        <%= errors?.genre ? 'border-red-500 ring-red-300' : 'border-gray-300' %>"
    >
      <% for (let genre of genres) { %>
        <option value="<%= genre.value %>" <%= selectedGenres.includes(genre.value) ? 'selected' : '' %>>
          <%= genre.title %>
        </option>
      <% } %>
    </select>

    <!-- Bi·ªÉu t∆∞·ª£ng dropdown gi·∫£ l·∫≠p ƒë·ªÉ tr√¥ng hi·ªán ƒë·∫°i -->
    <div class="pointer-events-none absolute inset-y-0 right-3 flex items-center text-gray-400">
      <i class="fas fa-chevron-down"></i>
    </div>
  </div>

  <% if (errors?.genre) { %>
    <p class="text-sm text-red-600 mt-2"><%= errors.genre %></p>
  <% } %>
</div>



    <div>
      <label for="author" class="block text-sm font-medium text-gray-700 mb-2">
        <i class="fas fa-user-edit text-orange-500 mr-2"></i> T√°c gi·∫£
      </label>
      <input
        name="author"
        type="text"
        class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2
          <%= errors?.author ? 'border-red-500 ring-red-300' : 'border-gray-300 focus:ring-blue-500 focus:border-transparent' %>"
        placeholder="T√™n t√°c gi·∫£..."
        value="<%= old?.author || '' %>"
      />
      <% if (errors?.author) { %>
        <p class="text-sm text-red-600 mt-1"><%= errors.author %></p>
      <% } %>
    </div>
  </div>

  <div class="border-t pt-6 mt-6">
  <h2 class="text-lg font-semibold mb-4 text-gray-800">Ch∆∞∆°ng ƒë·∫ßu ti√™n</h2>

  <div class="mb-4">
    <label class="block text-sm font-medium text-gray-700 mb-2">Ti√™u ƒë·ªÅ ch∆∞∆°ng</label>
    <input
      type="text"
      name="chapter_title"
      class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 border-gray-300 focus:ring-blue-500"
      placeholder="Ch∆∞∆°ng 1 - ..."
    />
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700 mb-2">N·ªôi dung ch∆∞∆°ng</label>
    <textarea
      name="chapter_content"
      rows="6"
      class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 border-gray-300 focus:ring-blue-500"
      placeholder="N·ªôi dung ch∆∞∆°ng 1..."
    ></textarea>
  </div>
</div>


<!-- ƒê√°nh d·∫•u truy·ªán n·ªïi b·∫≠t -->
<div>
  <label for="is_featured" class="flex items-center space-x-3">
    <input
      name="is_featured"
      type="checkbox"
      class="w-4 h-4 text-yellow-500 bg-gray-100 border-gray-300 rounded focus:ring-yellow-400 focus:ring-2"
      <%= old?.is_featured ? 'checked' : '' %>
    />
    <span class="text-sm font-medium text-gray-700">
      <i class="fas fa-star text-yellow-500 mr-2"></i> ƒê√°nh d·∫•u l√† truy·ªán n·ªïi b·∫≠t
    </span>
  </label>
</div>

  <!-- ƒê√°nh gi√°, S·ªë ng∆∞·ªùi ƒë·ªçc, Ng√†y ph√°t h√†nh -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <div>
      <label for="rating" class="block text-sm font-medium text-gray-700 mb-2">
        <i class="fas fa-star text-yellow-500 mr-2"></i> ƒê√°nh gi√°
      </label>
      <select
        name="rating"
        class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2
          <%= errors?.rating ? 'border-red-500 ring-red-300' : 'border-gray-300 focus:ring-blue-500 focus:border-transparent' %>"
      >
        <option value="">Ch·ªçn ƒë√°nh gi√°</option>
        <% for (let i = 1; i <= 5; i++) { %>
          <option value="<%= i %>" <%= old?.rating == i ? 'selected' : '' %>><%= i %> sao</option>
        <% } %>
      </select>
      <% if (errors?.rating) { %>
        <p class="text-sm text-red-600 mt-1"><%= errors.rating %></p>
      <% } %>
    </div>

    <div>
      <label for="readers" class="block text-sm font-medium text-gray-700 mb-2">
        <i class="fas fa-users text-red-500 mr-2"></i> S·ªë l∆∞·ª£ng ng∆∞·ªùi ƒë·ªçc
      </label>
      <input
        name="readers"
        type="number"
        class="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2
          <%= errors?.readers ? 'border-red-500 ring-red-300' : 'border-gray-300 focus:ring-blue-500 focus:border-transparent' %>"
        placeholder="0"
        min="0"
        value="<%= old?.readers || '' %>"
      />
      <% if (errors?.readers) { %>
        <p class="text-sm text-red-600 mt-1"><%= errors.readers %></p>
      <% } %>
    </div>

   <% 
  const releaseDateISO = old?.release_date || ''; 
  const releaseDateVN = releaseDateISO
    ? new Date(releaseDateISO).toLocaleDateString('vi-VN')
    : '';
%>

<div class="mb-6">
  <label for="release_date" class="block text-sm font-semibold text-gray-800 mb-2">
    <i class="fas fa-calendar-alt text-teal-500 mr-2"></i> Ng√†y ph√°t h√†nh
  </label>

  <input
    name="release_date"
    type="date"
    class="w-full px-4 py-2 border rounded-xl shadow-sm text-sm
      focus:outline-none focus:ring-2
      <%= errors?.release_date ? 'border-red-500 ring-red-300' : 'border-gray-300 focus:ring-blue-500' %>"
    value="<%= releaseDateISO %>"
  />

  <% if (releaseDateVN) { %>
    <p class="mt-2 text-sm text-gray-600">
      üìÖ Hi·ªÉn th·ªã: <strong><%= releaseDateVN %></strong>
    </p>
  <% } %>

  <% if (errors?.release_date) { %>
    <p class="text-sm text-red-600 mt-1"><%= errors.release_date %></p>
  <% } %>
</div>



  </div>

  <!-- Tr·∫°ng th√°i ho√†n th√†nh -->
  <div>
    <label for="is_completed" class="flex items-center space-x-3">
      <input
        name="is_completed"
        type="checkbox"
        class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"
        <%= old?.is_completed ? 'checked' : '' %>
      />
      <span class="text-sm font-medium text-gray-700">
        <i class="fas fa-check-circle text-green-500 mr-2"></i> ƒê√£ ho√†n th√†nh
      </span>
    </label>
  </div>

  <!-- N√∫t h√†nh ƒë·ªông -->
  <div class="flex justify-end space-x-4 pt-6 border-t">
 <a href="/admin/stories">
     <button
      type="button"
      class="px-6 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition duration-200"
    >
       <i class="fas fa-arrow-left mr-2"></i>
  Quay l·∫°i
    </button></a>
    <button
      type="submit"
      class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-200"
    >
      <i class="fas fa-save mr-2"></i> L∆∞u truy·ªán
    </button>
  </div>
</form>

            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
